# iFarma — Генератор Синопсиса БЭ-Исследования

Flutter Web приложение для автоматической генерации синопсиса протокола биоэквивалентности.

## Структура проекта

```
ifarma_flutter/
├── lib/
│   ├── main.dart                          # Точка входа
│   ├── models/
│   │   └── models.dart                    # Data models (FormData, HistoryItem, ChatMessage, etc.)
│   ├── screens/
│   │   └── dashboard_screen.dart          # Главный экран с 3-колоночным layout
│   ├── services/
│   │   ├── app_state.dart                 # State management (ChangeNotifier + Provider)
│   │   └── dictionaries.dart              # Справочники: МНН, формы, дозировки, производители
│   ├── theme/
│   │   └── app_theme.dart                 # Цвета, шрифты, тема
│   └── widgets/
│       ├── autocomplete_field.dart        # Поле с автоподсказками
│       ├── collapsible_section.dart       # Сворачиваемая секция
│       └── tags_input.dart                # Ввод тегов (вспом. вещества)
├── web/
│   └── index.html                         # HTML-обёртка для Flutter Web
├── pubspec.yaml
└── README.md
```

## Запуск

```bash
# 1. Убедитесь что Flutter установлен (>= 3.2.0)
flutter --version

# 2. Получите зависимости
flutter pub get

# 3. Запустите для web
flutter run -d chrome

# 4. Или соберите для деплоя
flutter build web
```

## Архитектура

- **State Management**: Provider + ChangeNotifier (`AppState`)
- **Layout**: 3-колоночный (340px / flex / 340px)
  - **Левая**: форма ввода с 6 сворачиваемыми блоками
  - **Центр**: редактор документов
  - **Правая**: прогресс агентов + история + чат-ассистент

## Поля ввода (порядок)

### Блок 1 — Обязательные
- МНН (с автоподсказками, рус/англ, fuzzy search)
- Лекарственная форма (autocomplete из справочника 30+ форм)
- Дозировка (подсказки на основе МНН)
- Название ИП (необязательное)
- Условия хранения ИП (обязательное, для дженерика)

### Блок 2 — Производитель/Спонсор
- Производитель (autocomplete)
- Чекбокс «Производитель = Спонсор»
- Спонсор (если чекбокс снят)

### Блок 3 — Референтный препарат
- Референтный препарат (autocomplete, приоритет по МНН)
- Вспомогательные вещества (мультитеговый ввод)

### Блок 4 — Организационные данные
- ID протокола (ручной / автогенерация / пустой)
- Исследовательский центр
- Биоаналитическая лаборатория
- Страховая компания

### Блок 5 — ФК параметры (опционально)
- CVintra (%)
- T½ (часы)

### Блок 6 — Параметры дизайна
- Пол добровольцев
- Возраст (диапазон)
- Ограничения по курению
